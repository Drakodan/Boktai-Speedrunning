<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Boktai Speedrunning Knowledge Database</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">
    <script src="https://kit.fontawesome.com/862c8f61fa.js" crossorigin="anonymous"></script>
    <script src="/Boktai-Speedrunning/DungeonRanking.js"></script>
    <!-- <script src="DungeonRanking.js"></script> -->
  </head>
  <body onload="calc_HP_refill(); calc_dungeonRank(); findDungeonBaseScore();">
    <nav class="navbar" role="navigation" aria-label="main navigation">
      <div class="navbar-brand">
        <a class="navbar-item" href="https://github.com/shenef/Boktai-Speedrunning">
        <img src="https://upload.wikimedia.org/wikipedia/en/d/d1/Boktai_Series_Logo.png">
        </a>
      </div>
    </nav>
    <section class="section">
      <div class="container">
        <h1 class="title is-1">Boktai Speedrunning Knowledge Database</h1>
        <h2 class="title is-2">Game Mechanics</h2>

        <div class="card block">
          <header class="card-header">
            <p class="card-header-title">
              Purification Analysis
            </p>
            <button class="card-header-icon card-toggle" aria-label="more options">
              <span class="icon"><i class="fas fa-angle-down" aria-hidden="true"></i></span>
            </button>
          </header>
          <div class="card-content is-hidden">
            <div class="content">
                Top Left Tower Memory Address: <code>EWRAM 0x008436</code><br>
                Bottom Right Tower Memory Address: <code>EWRAM 0x0086C6</code><br>
                Top Right Tower Memory Address: <code>EWRAM 0x008956</code><br>
                Bottom Left Tower Memory Address: <code>EWRAM 0x008BE6</code><br>
                Purified Boss Health Memory Address: <code>EWRAM 0x03DAF4</code><br>
                <br>
                Tower Values range from 0 to 6500<br>
                0 to 1080 deals damage (hereby considered active)<br>
                1081 to 6499 deals no damage (hereby considered not active)<br>
                6500 is turned off and has to be manually turned back on.<br>
                <br>
                The towers continuously increase their value at a seemingly random speed.<br>
                Shooting/Spreading at a tower reduces the value by an amount that varies with the frame and probably also the lens.<br>
                <br>
                If a Tower is frozen or burning it does not deal damage.<br>
                Somewhere between 1070 and 1080 the beam starts to flicker, when flickering the beam seemingly only deals damage when the game displays a frame that shows the beam active. At 1081 and above it can flicker but i have never seen it deal damage.<br>
                <br>
                4 Towers<br>
                all Towers active:
                <ul>
                  <li>1 Lux: 24 dmg/frame</li>
                  <li>2 Lux: 32 dmg/frame</li>
                  <li>3 Lux: 40 dmg/frame</li>
                  <li>4 Lux: 48 dmg/frame</li>
                  <li>5 Lux: 56 dmg/frame</li>
                  <li>6 Lux: 64 dmg/frame</li>
                  <li>7 Lux: 72 dmg/frame</li>
                  <li>8 Lux: 80 dmg/frame</li>
                </ul>
                <br>
                8 Lux with 4/4 towers active: 80 dmg/frame<br>
                8 Lux with 3/4 towers active: 30 dmg/frame<br>
                8 Lux with 2/4 towers active: 20 dmg/frame<br>
                8 Lux with 1/4 towers active: 10 dmg/frame<br>
                <br>
                2 Towers<br>
                all Towers active:
                <ul>
                  <li>1 Lux: 12 dmg/frame</li>
                  <li>2 Lux: 16 dmg/frame</li>
                  <li>3 Lux: 20 dmg/frame</li>
                  <li>4 Lux: 24 dmg/frame</li>
                  <li>5 Lux: 28 dmg/frame</li>
                  <li>6 Lux: 32 dmg/frame</li>
                  <li>7 Lux: 36 dmg/frame</li>
                  <li>8 Lux: 40 dmg/frame</li>
                </ul>
                <br>
                8 Lux with 2/2 towers active: 40 dmg/frame<br>
                8 Lux with 1/2 towers active: 10 dmg/frame<br>
            </div>
          </div>
        </div>

        <div class="card block">
          <header class="card-header">
            <p class="card-header-title">
              Hel Phase 1 Analysis
            </p>
            <button class="card-header-icon card-toggle" aria-label="more options">
              <span class="icon"><i class="fas fa-angle-down" aria-hidden="true"></i></span>
            </button>
          </header>
          <div class="card-content is-hidden">
            <div class="content">
              Otenko Charge Memory Address: <code>EWRAM 0x00766C</code><br>
              19200 energy needed per tower (76800 in total)<br>
              <br>
              Minimum charging speed: 6 energy/frame (when using the Gun del Hell)<br>
              Default charging speed: 12 energy/frame<br>
              Maximum charging speed: 17 energy/frame<br>
              That can be achieved either by spreading at otenko or using a RSG and topping it off with a spread<br>
              <br>
              Otenko charging times per charging speed<br>
              106,66 sec at 12 (no RSG, no spread)<br>
              85,33 sec at 15 (full fight with only RSG)<br>
              75,29 sec at 17<br>
              <br>
              Otenko does not charge
              <ul>
                <li>during a Hel attack</li>
                <li>when he is down after an attack</li>
                <li>when traveling between towers</li>
                <li>during the summon animation</li>
              </ul>
              <br>
              Different Frames make the charging speed rise to the max at different speeds
              <ul>
                <li>Spread frames are fast</li>
                <li>Sword frames generally seem a little slower than Spread frames</li>
                <li>Shotgun frames require constant spamming but aren't too bad, they bump it to 17 pretty much instantly</li>
                <li>Rotating frames are just bad (they only increase when the spread is covering otenko)</li>
                <li>Guardian seems overpowered</li>
              </ul>
              (Note: i don't have a rate of change for the charging speed per frame, it's an estimation from looking at the diff)<br>
              <br>
              Frames with no Effect:<br>
              <ul>
                <li>Fighter</li>
                <li>Knife, Dagger, Gradius, Calamity</li>
                <li>Juggler, Wizard, Beatmania</li>
              </ul>
            </div>
          </div>
        </div>

        <h2 class="title is-2">Tools</h2>

        <div class="card block">
          <header class="card-header">
            <p class="card-header-title">
              Dungeon Ranking Calculator
            </p>
            <button class="card-header-icon card-toggle" aria-label="more options">
              <span class="icon"><i class="fas fa-angle-down" aria-hidden="true"></i></span>
            </button>
          </header>
          <div class="card-content">
            <div class="content">
              Work in Progress

              <div class="field is-horizontal">
                <div class="field-label is-normal">
                  <label class="label">Dungeon Score</label>
                </div>
                <div class="field-body">
                  <div class="field">
                    <p class="control">
                      <input class="input" type="number" id="dungeonScore" value="1000" onchange="calc_dungeonRank();">
                    </p>
                  </div>
                </div>
              </div>

              <div class="field is-horizontal">
                <div class="field-label is-normal">
                  <label class="label">Dungeon Rank</label>
                </div>
                <div class="field-body">
                  <div class="field">
                    <p class="control">
                      <input class="input is-static" id="dungeonRank">
                    </p>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>

        <div class="card block">
          <header class="card-header">
            <p class="card-header-title">
              Automatic HP refill Calculator
            </p>
            <button class="card-header-icon card-toggle" aria-label="more options">
              <span class="icon"><i class="fas fa-angle-down" aria-hidden="true"></i></span>
            </button>
          </header>
          <div class="card-content">

            <div class="field is-horizontal">
              <div class="field-label is-normal">
                <label class="label">Starting HP</label>
              </div>
              <div class="field-body">
                <div class="field">
                  <p class="control">
                    <input class="input" type="number" id="currentHP" value="1000" onchange="calc_HP_refill()">
                  </p>
                </div>
              </div>
            </div>

            <div class="field is-horizontal">
              <div class="field-label is-normal">
                <label class="label">Max. HP</label>
              </div>
              <div class="field-body">
                <div class="field">
                  <p class="control">
                    <input class="input" type="number" id="maxHP" value="5000" onchange="calc_HP_refill()">
                  </p>
                </div>
              </div>
            </div>

            <div class="field is-horizontal">
              <div class="field-label is-normal">
                <label class="label">Frames until max. HP</label>
              </div>
              <div class="field-body">
                <div class="field">
                  <p class="control">
                    <input class="input is-static" id="ftmhp">
                  </p>
                </div>
              </div>
            </div>

            <p>
              When Automatic HP refill is active the game refills 50 HP every Frame. <br>
              You start the game with 5000 HP and Life Fruits increase your HP in 1000 HP increments up to a maximum of 9000 HP.<br>
              Automatic HP refill usually happens after Bossfights, Purifications or Traps.
            </p>

            <script type="text/javascript">
              function calc_HP_refill() {
                let currentHP = document.getElementById('currentHP').value;
                let maxHP = document.getElementById('maxHP').value;
                let ftmhp = Math.floor((maxHP - currentHP) / 50) //ftmhp = frames till max HP
                document.getElementById('ftmhp').value = ftmhp;
              }
            </script>
          </div>
        </div>

        <h2 class="title is-2">Scripts</h2>

        <div class="content">
          <ul>
            <li>General Info:
              <a href="https://raw.githubusercontent.com/shenef/Boktai-Speedrunning/main/Boktai1_General_Info.lua">https://raw.githubusercontent.com/shenef/Boktai-Speedrunning/main/Boktai1_General_Info.lua</a><br>
              Shows info on screen. Player and Boss HP, current and average speed, damage per second and energy charge per battery.
            </li>
          </ul>
        </div>

      </div>
    </section>
  </body>
  <script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function() {
    	let cardToggles = document.getElementsByClassName('card-toggle');
    	for (let i = 0; i < cardToggles.length; i++) {
    		cardToggles[i].addEventListener('click', e => {
    			e.currentTarget.parentElement.parentElement.childNodes[3].classList.toggle('is-hidden');
    		});
    	}
    });
  </script>
</html>
